<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>General Store</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <style>
        body {
            padding: 0;
        }

        .float-right {
            float: right;
        }

        .form-control1 {
            width: 40%;
            float: right;
        }

        #main-header {
            height: 177px;
            background-color: green;
            color: white;
            font-size: 40px;
        }

        #filter {
            width: 77%;
            margin-top: 10%;
        }
    </style>
</head>
</head>

<header id="main-header" class="bg-success text-white p-4 mb-3">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h1 id="header-title">Groceries Items</h1>
            </div>
        </div>
    </div>
</header>


<div class="container">
    <div id="main" class="card card-body">
        <h2 class="title">Add Items</h2>
        <form id="addForm" class="form-inline mb-3">
            <input type="text" class="form-control mr-2" id="item" placeholder="ItemName">
            <input type="text" class="form-control " id="description" placeholder="Description">
            <input type="text" class="form-control mr-2" id="Price" placeholder="Price">
            <input type="text" class="form-control " id="Quantity" placeholder="Quantity">
            <input type="submit" class="btn btn-dark" value="Submit">
        </form>
        <h2 class="title">Items</h2>

        <ul id="items" class="list-group">
            <!-- <li class="list-group-item">Item 1 <button id="btn1">Buy1</button>  <button id="btn2">Buy2</button> <button id="btn3">Buy3</button>
             </li>
            <li class="list-group-item">Item 2 <button id="btn1">Buy1</button>  <button id="btn2">Buy2</button> <button id="btn3">Buy3</button>
            </li2>
            <li class="list-group-item">Item 3 <button id="btn1">Buy1</button>  <button id="btn2">Buy2</button> <button id="btn3">Buy3</button>
            </li>2
            <li class="list-group-item">Item 4 <button id="btn1">Buy1</button>  <button id="btn2">Buy2</button> <button id="btn3">Buy3</button>
            </li> -->
        </ul>
    </div>
</div>

<body>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
    <script>
        const details = document.getElementById('addForm');
        const item = document.getElementById('item');
        const description = document.getElementById('description');
        const Price = document.getElementById('Price');
        const Quantity = document.getElementById('Quantity');
        const items = document.getElementById('items');
        let count1 = 0;
        count2 = 0;
        count3 = 0;
        details.addEventListener(('submit'), myFromAlldetails);

        // Main creation 

        function myFromAlldetails(event) {
            event.preventDefault();

            const obj = {
                ItemName: item.value,
                Itemdescription: description.value,
                ItemPrice: Price.value,
                ItemQuantity: Quantity.value,
            }

            axios.post('https://crudcrud.com/api/92a83337f33b4c80bcc3b568356824ef/GroceriesItems', obj)
                .then((response) => {
                    allItems(response.data)
                })

        }

        function allItems(obj) {
            const li = document.createElement('li');
            li.appendChild(document.createTextNode(`${obj.ItemName} - ${obj.Itemdescription} - ${obj.ItemPrice} - ${obj.ItemQuantity}`))
            li.appendChild(BuyBtnOne(obj));
            li.appendChild(BuyBtnTwo(obj));
            li.appendChild(BuyBtnThree(obj));
            items.appendChild(li);
        }



        function updateQuantity(obj) {
            const li = obj._id;
            if (li) {
                li.textContent = `${obj.ItemName} - ${obj.Itemdescription} - ${obj.ItemPrice} - ${obj.ItemQuantity}`;
            }
            allItems(obj)
        }


        function BuyBtnOne(obj) {

            const btn1 = document.createElement('input')
            btn1.type = 'button'
            btn1.style.background = 'green'
            btn1.style.color = 'black'
            btn1.style.marginLeft = '20px'
            btn1.style.marginTop = '15px'
            btn1.value = 'BUY 1'

            btn1.onclick = () => {
                if (obj.ItemQuantity > 0) {
                    obj.ItemQuantity--;
                    updateQuantity(obj)
                }
            };
            return btn1;
        }
        function BuyBtnTwo(obj) {

            const btn2 = document.createElement('input')
            btn2.type = 'button'
            btn2.style.background = 'green'
            btn2.style.color = 'black'
            btn2.style.marginLeft = '20px'
            btn2.style.marginTop = '15px'
            btn2.value = 'BUY 2'

            btn2.onclick = () => {
                if (obj.ItemQuantity > 0) {
                    obj.ItemQuantity = obj.ItemQuantity - 2;
                    updateQuantity(obj)
                }
            }
            return btn2;
        }

        function BuyBtnThree(obj) {

            const btn3 = document.createElement('input')
            btn3.type = 'button'
            btn3.style.background = 'green'
            btn3.style.color = 'black'
            btn3.style.marginLeft = '20px'
            btn3.style.marginTop = '15px'
            btn3.value = 'BUY 3'

            btn3.onclick = () => {

                if (obj.ItemQuantity > 0) {
                    obj.ItemQuantity = obj.ItemQuantity - 3;
                    updateQuantity(obj)
                }

            }

            return btn3;
        }


        window.addEventListener(('load'), BrowserRefresh);

        function BrowserRefresh() {
            axios.get('https://crudcrud.com/api/92a83337f33b4c80bcc3b568356824ef/GroceriesItems')
                .then((response) => {
                    for (var i = 0; i < response.data.length; i++) {
                        const data = response.data[i];
                        allItems(data)
                    }
                })
        }



    </script>

</body>

</html>